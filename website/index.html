<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns#">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- CLEAN MARKUP = GOOD KARMA.
      Hi source code lover,

      you're a curious person and a fast learner ;)
      Let's make something beautiful together. Contribute on Github:
      https://github.com/webslides/webslides

      Thanks,
      @jlantunez.
    -->

  <!-- SEO -->
  <title>Raúl Heredia Presentation</title>
  <meta name="description" content="WebSlides is the easiest way to make HTML presentations, portfolios, and landings. Just essential features." />

  <!-- URL CANONICAL -->
  <!-- <link rel="canonical" href="http://your-url.com/"> -->

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,700,700i%7CMaitree:200,300,400,600,700&amp;subset=latin-ext" rel="stylesheet" />

  <!-- CSS WebSlides -->
  <link rel="stylesheet" type="text/css" media="all" href="static/css/webslides.css" />
  <link rel="stylesheet" type="text/css" media="all" href="static/css/personal.css" />

  <!-- Optional - CSS SVG Icons (Font Awesome) -->
  <link rel="stylesheet" type="text/css" media="all" href="static/css/svg-icons.css" />

  <!-- SOCIAL CARDS (ADD YOUR INFO) -->

  <!-- FACEBOOK -->
  <meta property="og:url" content="http://your-url.com/" />
  <!-- YOUR URL -->
  <meta property="og:type" content="article" />
  <meta property="og:title" content="WebSlides — Making HTML Presentations Easy" />
  <!-- EDIT -->
  <meta property="og:description" content="WebSlides is about telling stories beautifully. Just the essential features. Good karma." />
  <!-- EDIT -->
  <meta property="og:updated_time" content="2017-01-04T17:20:50" />
  <!-- EDIT -->
  <meta property="og:image" content="static/images/share-webslides.jpg" />
  <!-- EDIT -->

  <!-- TWITTER -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@webslides" />
  <!-- EDIT -->
  <meta name="twitter:creator" content="@jlantunez" />
  <!-- EDIT -->
  <meta name="twitter:title" content="WebSlides — Making HTML Presentations Easy" />
  <!-- EDIT -->
  <meta name="twitter:description" content="WebSlides is about good karma. Just essential features. 120+ free slides ready to use." />
  <!-- EDIT -->
  <meta name="twitter:image" content="static/images/share-webslides.jpg" />
  <!-- EDIT -->

  <!-- FAVICONS -->
  <link rel="shortcut icon" sizes="16x16" href="static/images/favicons/favicon.png" />
  <link rel="shortcut icon" sizes="32x32" href="static/images/favicons/favicon-32.png" />
  <link rel="apple-touch-icon icon" sizes="76x76" href="static/images/favicons/favicon-76.png" />
  <link rel="apple-touch-icon icon" sizes="120x120" href="static/images/favicons/favicon-120.png" />
  <link rel="apple-touch-icon icon" sizes="152x152" href="static/images/favicons/favicon-152.png" />
  <link rel="apple-touch-icon icon" sizes="180x180" href="static/images/favicons/favicon-180.png" />
  <link rel="apple-touch-icon icon" sizes="192x192" href="static/images/favicons/favicon-192.png" />

  <!-- Android -->
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="theme-color" content="#333333" />
</head>

<body>
  <main role="main">
    <article id="webslides" class="vertical">
      <!-- Quick Guide
          - Each parent <section> in the <article id="webslides"> element is an individual slide.
          - Vertical sliding = <article id="webslides" class="vertical">
          - <div class="wrap"> = container 90% / <div class="wrap size-50"> = 45%;
        -->
      <!---->
      <!---->
      <!---->
      <!-- Intro-->
      <!---->
      <!---->
      <!---->
      <section class="slide-center fullscreen bg-blue slide current">
        <span class="background dark" style="background-image:url('./static/my-images/dockbernetes.jpg"></span>
        <div class="wrap content-center">
          <h3>
            <strong>Despliegue de Wordpress con Docker-Compose y Kubernetes</strong>
          </h3>
          <p class="text-intro">
            <strong>
              Raúl Heredia<br />
              ASIX 2 Curs 2020-21
            </strong>
          </p>

        </div>
        <!-- .end .wrap -->
      </section>
      <!---->
      <!---->
      <!---->
      <!-- Índice-->
      <!---->
      <!---->
      <!---->
      <section class="slide-top">
        <div class=" wrap size-50">
          <h4 id="indice">Índice</h4>
          <hr>
          <div class="toc">
            <ol>
              <li>
                <a href="./index.html#slide=3" title="Tecnologías Usadas">
                  <span class="chapter">Tecnologías Usadas</span>
                  <span class="toc-page">03</span>
                </a>
              </li>
              <li>
                <a href="./index.html#slide=4" title="Tecnologías Usadas">
                  <span class="chapter">Diferencias Contenedores y VM</span>
                  <span class="toc-page">04</span>
                </a>
              </li>
              <li>
                <a href="./index.html#slide=5" title="Docker"><span class="chapter">Docker</span>
                  <span class="toc-page">05</span></a>
                <ol>
                  <li><a href="./index.html#slide=6" title="Docker Compose">
                      <span class="chapter">¿Qué es Docker-Compose?</span>
                      <span class="toc-page">06</span></a>
                  </li>
                  <li><a href="./index.html#slide=7" title="Wordpress Docker Compose">
                      <span class="chapter">Ejemplo de Docker Compose</span>
                      <span class="toc-page">07</span></a>
                  </li>
                  <li>
                    <a href="./index.html#slide=8" title="Docker"><span class="chapter">Desplegando Wordpress con Docker-Compose</span>
                      <span class="toc-page">08</span></a>
                    <ol>
                      <li><a href="./index.html#slide=9" title="Requisitos"><span class="chapter">Requisitos</span>
                          <span class="toc-page">09</span></a>
                      </li>
                      <li><a href="./index.html#slide=10" title="Archivo"><span class="chapter">Archivo Docker-Compose</span>
                          <span class="toc-page">10</span></a>
                      </li>
                      <li><a href="./index.html#slide=11" title="Comprobacion"><span class="chapter">Desplegando Wordpress</span>
                          <span class="toc-page">11</span></a>
                      </li>
                      <li><a href="./index.html#slide=12" title="Comprobacion"><span class="chapter">Comprobación de Funcionamiento</span>
                          <span class="toc-page">12</span></a>
                      </li>
                    </ol>
                  </li>
                </ol>
              </li>
              <li>
                <a href="./index.html#slide=13" title="Kubernetes">
                  <span class="chapter">Kubernetes</span>
                  <span class="toc-page">13</span>
                </a>
                <ol>
                  <li><a href="./index.html#slide=14" title="Requisitos"><span class="chapter">Estructura de Kubernetes</span>
                      <span class="toc-page">14</span></a>
                  </li>
                  <li><a href="./index.html#slide=15" title="Requisitos"><span class="chapter">Desplegando Wordpress con Kubernetes</span>
                      <span class="toc-page">15</span></a>
                    <ol>
                      <li><a href="./index.html#slide=16" title="Requisitos"><span class="chapter">Archivos necesarios para desplegar Wordpress en Kubernetes
                          </span>
                          <span class="toc-page">16</span></a>
                      </li>
                      <li><a href="./index.html#slide=17" title="Requisitos"><span class="chapter">Archivo kustomization.yaml</span>
                          <span class="toc-page">17</span></a>
                      </li>
                      <li><a href="./index.html#slide=18" title="Requisitos"><span class="chapter">Archivo mysql-deployment.yaml</span>
                          <span class="toc-page">18</span></a>
                      </li>
                      <li><a href="./index.html#slide=19" title="Requisitos"><span class="chapter">Archivo wordpress-deployment.yaml</span>
                          <span class="toc-page">19</span></a>
                      </li>
                      <li><a href="./index.html#slide=20" title="Requisitos"><span class="chapter">Despliegue y Comprobación de Funcionamiento</span>
                          <span class="toc-page">20</span></a>
                      </li>
                    </ol>
                  </li>
                </ol>
              </li>
            </ol>

          </div>
          <!-- end .toc -->
        </div>
      </section>
      <!---->
      <!---->
      <!---->
      <!-- Tecnologias usadas-->
      <!---->
      <!---->
      <!---->
      <section class="slide-top">
        <div class="wrap">
          <div class="content-left">
            <h4 class="title">
              <strong>Tecnoligías Usadas</strong>
              </h3>
          </div>
        </div>
        <ul class="flexblock clients">
          <li>
            <a href="https://www.docker.com/" target="_blank" title="Client">
              <figure>
                <img class="blacklogo" src="./static/my-images/docker.svg" alt=" Docker">
                <figcaption>
                  <h3>Docker</h3>
                  <p>Docker es una plataforma que permite crear, probar e implementar aplicaciones
                    rápidamente mediante el uso de contenedores virtuales.</p>
                </figcaption>
              </figure>
            </a>
          </li>
          <li>
            <a href="https://kubernetes.io/es/" target="_blank" title="Client">
              <figure>
                <img class="blacklogo" src="./static/my-images/kubernetes.svg" alt="Kubernetes">
                <figcaption>
                  <h3>Kubernetes</h3>
                  <p>Es una plataforma open source diseñada para automatizar las operaciones con contenedores, ejecutar aplicaciones y servicios distribuidos a escala.</p>
                </figcaption>
              </figure>
            </a>
          </li>
          <li>
            <a href="https://www.digitalocean.com/" target="_blank" title="Client">
              <figure>
                <img class="blacklogo" src="./static/my-images/digitalocean.svg" alt="DigitalOcean">
                <figcaption>
                  <h3>DigitalOcean</h3>
                  <p>DigitalOcean es un proveedor estadounidense de Servidores Virtuales Privados, cuenta con servidores
                    en Nueva York, Frankfurt, Madrid, etc.
                    Frankfurt, etc.</p>
                </figcaption>
              </figure>
            </a>
          </li>
        </ul>
      </section>
      <!---->
      <!---->
      <!---->
      <!-- Diferencias Contenedores y VM -->
      <!---->
      <!---->
      <!---->
      <section class="slide-top">
        <div class="wrap vertical-align">
          <img class="alignright size-50" src="./static/my-images/containervsvm.png" alt="Diferencia">
          <h4 class="title"><strong>Diferencias Contenedores y VM</strong></h3>
            <p class="justify">Las máquinas virtuales se ejecutan en un entorno de Hyper-V en el que cada máquina virtual debe incluir su
              propio sistema operativo invitado dentro, junto con sus archivos binarios, bibliotecas y aplicaciones
              relacionadas.</p>
            <p class="justify">En cambio, cada contenedor comparte el mismo SO host o kernel y tiene un tamaño mucho más
              ligero, a menudo sólo megabytes. En consecuencia, un contenedor puede tardar sólo segundos en
              iniciar</p>
        </div>
      </section>
      <!---->
      <!---->
      <!---->
      <!-- Docker -->
      <!---->
      <!---->
      <!---->
      <section class="slide-center">
        <div class="wrap content-center">
          <img src="static/my-images/docker.svg">
        </div>
      </section>

      <!---->
      <!---->
      <!---->
      <!-- Que es Docker Compose-->
      <!---->
      <!---->
      <!---->
      <section class="slide-top">
        <div class="wrap vertical-align">
          <div class="grid">
            <div class="column">
              <h4 class="title"><strong>¿Qué es Docker-Compose?</strong></h3>
                <p class="justify">
                  Docker Compose es una herramienta que permite simplificar el uso de Docker. En vez de utilizar Docker
                  via una serie inmemorizable de comandos de bash y scripts, Docker Compose permite mediante archivos YAML
                  poder instruir al Docker Engine a realizar tareas,programaticamente.
                </p>
            </div>
            <div class="column">
              <h4 class="title"><strong>Comandos Básicos:</strong></h3>
                <pre><span>$ docker-compose up -d</span> 
<span>$ docker-compose stop</span> 
<span>$ docker-compose start</span> 
<span>$ docker-compose restart</span> 
<span>$ docker-compose rm</span></pre>
            </div>
          </div>
        </div>
      </section>
      <!---->
      <!---->
      <!---->
      <!-- Ejemplo Docker Compose-->
      <!---->
      <!---->
      <!---->
      <section class="slide-top">
        <div class="wrap">
          <h4 class="title"><strong>Ejemplo de Docker-Compose</strong></h3>
            <pre class="compose-example">
<span class="first-yaml">version:</span><span class="second-yaml">'3.7'</span> 
<span class="first-yaml">services:</span>
  <span class="first-yaml">web:</span>
    <span class="first-yaml">container_name:</span><span class="second-yaml">"nginx_compose"</span>
    <span class="first-yaml">image:</span><span class="second-yaml">nginx:alpine</span>
    <span class="first-yaml">volumes:</span>
      <span class="second-yaml">- ./content:/usr/share/nginx/html</span>
    <span class="first-yaml">restart:</span><span class="second-yaml">unless-stopped</span>
</pre>
        </div>
      </section>
      <!---->
      <!---->
      <!---->
      <!-- Desplegando Wordpress con Docker-Compose-->
      <!---->
      <!---->
      <!---->
      <section class="slide-center">
        <div class="wrap content-center">
          <h4 class="title"><strong>Desplegando Wordpress con Docker-Compose</strong></h4>
        </div>
        <div class="wrap">
          <center>
            <img src="static/my-images/docker.svg"><img src="static/my-images/wordpress.svg">
          </center>
        </div>
      </section>
      <!---->
      <!---->
      <!---->
      <!-- Requisitos-->
      <!---->
      <!---->
      <!---->
      <section class="slide-top">
        <div class="wrap vertical-align">
          <h4 class="title"><strong>Requisitos</strong></h3>
            <ul class="flexblock clients">
              <li>
                <a href="https://www.mysql.com/" target="_blank" title="Client">
                  <figure>
                    <img src="./static/my-images/mysql.svg" alt="MySQL">
                    <figcaption>
                      <h3>MySQL</h3>
                      <p>Necesitaremos un contenedor de MySQL para almacenar los datos de nuestro Wordpress.</p>
                    </figcaption>
                  </figure>
                </a>
              </li>
              <li>
                <a href="https://wordpress.com/es/" target="_blank" title="Client">
                  <figure>
                    <img src="./static/my-images/wordpress.svg" alt=" Worpdress">
                    <figcaption>
                      <h3>Worpdress</h3>
                      <p>Necesitaremos un contenedor de Wordpress, el cual dependerá del contenedor de MySQL.</p>
                    </figcaption>
                  </figure>
                </a>
              </li>
              <li>
                <a href="https://www.phpmyadmin.net/" target="_blank" title="Client">
                  <figure>
                    <img src="./static/my-images/phpmyadmin.svg" alt="phpMyAdmin">
                    <figcaption>
                      <h3>phpMyAdmin</h3>
                      <p>Opcionalmente, podemos crear un contenedor de phpMyAdmin para poder gestionar nuestra base de datos.</p>
                    </figcaption>
                  </figure>
                </a>
              </li>
            </ul>
        </div>
      </section>
      <!---->
      <!---->
      <!---->
      <!-- Archivo Docker Compose-->
      <!---->
      <!---->
      <!---->
      <section class="slide-top">
        <div class="wrap vertical-align">
          <h4 class="title"><strong>Archivo Docker Compose</strong></h3>
            <script src="https://gist.github.com/raul-heredia/7020b4772a42f05e236619cbe47be471.js"></script>
        </div>
        </div>
      </section>
      <!---->
      <!---->
      <!---->
      <!-- Desplegando Wordpress-->
      <!---->
      <!---->
      <!---->
      <section class="slide-top">
        <div class="wrap vertical-align">
          <h4 class="title"><strong>Desplegando Wordpress</strong></h3>
            <pre class="terminal"><span class="user">raulh@server</span>:<span class="folder">~/docker/wordpress</span>$ docker-compose up -d
<span>Pulling db (mysql:5.7)...</span>
<span>5.7: Pulling from library/mysql</span>
<span>< ... ></span>
<span>Status: Downloaded newer image for mysql:5.7</span>
<span>Pulling phpmyadmin (phpmyadmin/phpmyadmin)...</span>
<span>latest: Pulling from phpmyadmin/phpmyadmin</span>
<span>< ... ></span>
<span>Status: Downloaded newer image for phpmyadmin/phpmyadmin:latest</span>
<span>Pulling wordpress (wordpress:latest)...</span>
<span>latest: Pulling from wordpress:latest</span>
<span>< ... ></span>
<span>Status: Downloaded newer image for wordpress:latest</span>
<span>Creating wordpress_db_1 ... </span> <span class="user">done</span>
<span>Creating wordpress_wordpress_1 ... </span> <span class="user">done</span>
<span>Creating wordpress_phpmyadmin_1 ... </span> <span class="user">done</span>
<span class="user">raulh@server</span>:<span class="folder">~/docker/wordpress</span>$
</pre>
        </div>
      </section>
      <!---->
      <!---->
      <!---->
      <!-- Comprobación de Funcionamiento-->
      <!---->
      <!---->
      <!---->
      <section class="slide-top">
        <div class="wrap vertical-align">
          <h4 class="title"><strong>Comprobación de Funcionamiento</strong></h4>
          <pre class="terminal"><span class="user">raulh@server</span>:<span class="folder">~/docker/wordpress</span>$ docker ps
<span>CONTAINER ID  IMAGE                   COMMAND                   CREATED         STATUS          PORTS                   NAMES</span>
<span>9252f84dc73c  phpmyadmin/phpmyadmin   "/docker-entrypoint..."   5 minutes ago   Up 5 minutes    0.0.0.0:8080->80/tcp    wordpress_phpmyadmin_1</span>
<span>7883d9e77e82  wordpress:latest        "/docker-entrypoint..."   5 minutes ago   Up 5 minutes    0.0.0.0:8000->80/tcp    wordpress_wordpress_1</span>
<span>dab6e9f28df3  mysql:5.7               "/docker-entrypoint..."   5 minutes ago   Up 5 minutes    3306/tcp,  33060/tcp    wordpress_db_1</span>
<span class="user">raulh@server</span>:<span class="folder">~/docker/wordpress</span>$
</pre>
          <p>Para acceder lo hacemos mediante la dirección IP y el puerto, en este caso el 8000 para Wordpress y el 8080 para phpmyadmin. O configurando un reverse proxy que nos redirija a los distintos servicios según el dominio entrante.</p>
        </div>
      </section>
      <!---->
      <!---->
      <!---->
      <!-- Kubernetes-->
      <!---->
      <!---->
      <!---->
      <section class="slide-center">
        <div class="wrap content-center">
          <img src="static/my-images/kubernetes.svg">
        </div>
      </section>
      <section class="slide-top">
        <div class="wrap vertical-align">
          <h4 class="title"><strong>Estructura de Kubernetes</strong></h4>
          <center><img src="static/my-images/kubestructure.png" width="600px"></center>
        </div>
      </section>
      <section class="slide-center">
        <div class="wrap content-center">
          <h4 class="title"><strong>Desplegando Wordpress con Kubernetes</strong></h4>
        </div>
        <div class="wrap">
          <center>
            <img src="static/my-images/kubernetes.svg"><img src="static/my-images/wordpress.svg">
          </center>
        </div>
      </section>
      <section class="slide-top">
        <div class="wrap vertical-align">
          <h4 class="title"><strong>Archivos necesarios para desplegar Wordpress en Kubernetes</strong></h4>
          <ul>
            <li>kustomization.yaml - Archivo Secret donde guardaremos la contraseña de Mysql</li>
            <li>mysql-deployment.yaml - Archivo que contendrá los parámetros para iniciar mysql</li>
            <li>wordpress-deployment.yaml - Archivo que contendrá los parámetros para iniciar Wordpress</li>
          </ul>
        </div>
      </section>
      <section class="slide-top">
        <div class="wrap vertical-align">
          <h4 class="title"><strong>Archivo kustomization.yaml</strong></h4>
          <pre class="compose-example"><span class="first-yaml">secretGenerator:</span> 
  <span class="first-yaml">- name: </span><span class="second-yaml">mysql-pass</span>
    <span class="first-yaml">literals:</span>
    <span class="second-yaml">- password=&lt;YOUR_PASSWORD_HERE&gt;
<span class="first-yaml">resources:</span>
    <span class="second-yaml">- mysql-deployment.yaml</span>
    <span class="second-yaml">- wordpress-deployment.yaml</span>
            </pre>
        </div>
      </section>
      <section class="slide-top">
        <div class="wrap vertical-align">
          <h4 class="title"><strong>Archivo mysql-deployment.yaml</strong></h4>
          <script src="https://gist.github.com/raul-heredia/41758a26757c51d0ec510e25ad5c4c0b.js"></script>
        </div>
      </section>
      <section class="slide-top">
        <div class="wrap vertical-align">
          <h4 class="title"><strong>Archivo wordpress-deployment.yaml</strong></h4>
          <script src="https://gist.github.com/raul-heredia/509ff7a3e1fa6aeb6985919cedb41165.js"></script>
        </div>
      </section>
      <section class="slide-top">
        <div class="wrap vertical-align">
          <h4 class="title"><strong>Despliegue y Comprobación de Funcionamiento</strong></h4>
          <pre class="terminal"><span class="user">root@ubuntu-minikube</span>:<span class="folder">~/kube/wordpress</span># kubectl apply -k ./
<span>secret/mysql-pass-99f42cmt75 created</span>
<span>service/wordpress created</span>
<span>service/wordpress-mysql created</span>
<span>persistentvolumeclaim/mysql-pv-claim created</span>
<span>persistentvolumeclaim/wp-pv-claim created</span>
<span>deployment.apps/wordpress created</span>
<span>deployment.apps/wordpress-mysql created</span>
<span class="user">root@ubuntu-minikube</span>:<span class="folder">~/kube/wordpress</span># kubectl get pods
<span>NAME                            READY   STATUS   RESTARS  AGE</span>
<span>wordpress-6dcc6778d5-cqvb4      1/1     Running  0        13s</span>
<span>wordpress-mysql-cc87dc69-t88bd  1/1     Running  0        13s</span>
<span class="user">root@ubuntu-minikube</span>:<span class="folder">~/kube/wordpress</span># kubectl get svc
<span>NAME              TYPE          CLUSTER-IP      EXTERNAL-IP     PORT(S)       AGE</span>
<span>kubernetes        ClusterIP     10.96.0.1       &lt;none&gt;          443/TCP       21h</span>
<span>Worpdress         LoadBalancer  10.109.151.200  &lt;pending&gt;       80:32327/TCP  16s</span>
<span>wordpress-mysql   ClusterIP     None            &lt;none&gt;          3306/TCP      16s</span>
</pre>
        </div>
      </section>
      <section class="slide-top">
        <div class="wrap vertical-align">
          <h4 class="title"><strong></strong></h4>

        </div>
      </section>
      <section class="slide-top">
        <div class="wrap vertical-align">
          <h4 class="title"><strong></strong></h4>

        </div>
      </section>
      <section class="slide-top">
        <div class="wrap vertical-align">
          <h4 class="title"><strong></strong></h4>

        </div>
      </section>


      <!-- Required -->
      <script src="static/js/webslides.js"></script>
      <script>
        window.ws = new WebSlides();
      </script>

      <!-- OPTIONAL - svg-icons.js (fontastic.me - Font Awesome as svg icons) -->
      <script defer src="static/js/svg-icons.js"></script>
</body>

</html>